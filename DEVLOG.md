# Development Log

История изменений для cherry-pick в main.

## #86 — не уменьшай и не уводи в полупрозрачность кости которые убираются и летят друг к
**Дата:** 2026-02-06  
**Ветка:** dev/Gleb  
**Коммит:** `b5026dd`  
**Статус:** ✅ готово к переносу

### Изменённые файлы
- `app.js`

### Как перенести в main
```bash
git cherry-pick b5026dd48a9568157b948dcc4bfdb86adb8e58cc
```

---


## #86 — не уменьшай и не уводи в полупрозрачность кости которые убираются и летят друг к
**Дата:** 2026-02-06
**Ветка:** dev/Gleb
**Коммит:** `7b019ba`
**Статус:** ✅ готово к переносу

### Что сделано
Убрано уменьшение (scale) и затухание (opacity) костей при анимации удаления. Теперь кости летят друг к другу в оригинальном размере и полной непрозрачности, исчезая только в точке встречи.

### Изменённые файлы
- `app.js` — убраны строки scale и opacity из функции animateArc

### Как перенести в main
```bash
git cherry-pick 7b019baedccfa071d020fe9647b7e078e068fc41
```

---

## #85 — когда нет ходов и случается перемешивание кости улетают и не возвращаются обратно
**Дата:** 2026-02-06
**Ветка:** dev/Gleb
**Коммит:** `0e94bc4`
**Статус:** ✅ готово к переносу

### Что сделано
Исправлена ошибка при перемешивании доски: кости улетали за экран и не возвращались обратно. Проблема была двойная: 1) координаты fly-out вычислялись некорректно — вместо чистых смещений от текущей позиции использовались абсолютные координаты с вычитанием позиции, что давало недостаточные смещения; 2) если событие animationend не срабатывало хотя бы для одной кости (что случается в мобильных WebView), reshuffle никогда не вызывался. Исправлены расчёты на чистые относительные смещения и добавлен safety fallback таймер.

### Изменённые файлы
- `app.js` — исправлен расчёт fly-out смещений в shuffleTiles() (чистые относительные offX/offY вместо абсолютных координат), добавлен флаг reshuffleDone для предотвращения двойного вызова, добавлен fallback setTimeout для гарантированного вызова doReshuffle()

### Как перенести в main
```bash
git cherry-pick 0e94bc42ea3a35a8e1f48e4f9aa4499736500f4b
```

---

<<<<<<< HEAD
## #83 — спозиционируй аккуратнее картинки которые с прямоугольниками относительно костяш
**Дата:** 2026-02-06  
**Ветка:** dev/Gleb  
**Коммит:** `f0ad923`  
**Статус:** ✅ готово к переносу

### Изменённые файлы
- `app.js`
- `style.css`
- `tickets/issue-84/screenshot.jpg`

### Как перенести в main
```bash
git cherry-pick f0ad923d32d1a08bd9776731c14dd2f9c1c7a8c3
```

---


=======
>>>>>>> cd87719 (feat: когда нет ходов и случается перемешивание кости улетают и не возвращаются обратн (#85))
## #83 — спозиционируй аккуратнее картинки которые с прямоугольниками относительно костяш
**Дата:** 2026-02-06
**Ветка:** dev/Gleb
**Коммит:** `bbaab1b`
**Статус:** ✅ готово к переносу

### Что сделано
Добавлен padding-bottom: 8% к .tile-face, чтобы визуально поднять символы маджонга (Unicode-глифы с прямоугольными рамками) ближе к центру костяшки. Глифы с рамками имеют смещённый вниз визуальный центр, padding компенсирует это.

### Изменённые файлы
- `style.css` — добавлен padding-bottom: 8% к .tile-face для вертикального центрирования символов

### Как перенести в main
```bash
git cherry-pick bbaab1b6a03654c658c40ded4e3b986549e930f2
```

---

## #82 — теперь кости иногда не влазят по высоте и обрезаются
**Дата:** 2026-02-06
**Ветка:** dev/Gleb
**Коммит:** `3582873`
**Статус:** ✅ готово к переносу

### Изменённые файлы
- `app.js`
- `style.css`

### Как перенести в main
```bash
git cherry-pick 35828735f7a9f99dff57ba188a0dfa171deef2bd
```

---


## #82 — теперь кости иногда не влазят по высоте и обрезаются
**Дата:** 2026-02-06
**Ветка:** dev/Gleb
**Коммит:** `2f423a6`
**Статус:** ✅ готово к переносу

### Что сделано
Исправлена проблема обрезки костяшек по высоте. В calculateLayout() добавлена проверка итоговых размеров доски (включая смещения слоёв и отступы) — если доска не помещается в доступное пространство, размер тайлов уменьшается пропорционально. Также исправлен расчёт размеров доски в renderBoard(): вместо захардкоженного множителя 4 используется реальное количество активных слоёв.

### Изменённые файлы
- `app.js` — добавлена верификация размера доски в calculateLayout(), исправлен расчёт boardW/boardH в renderBoard()

### Как перенести в main
```bash
git cherry-pick 2f423a6fc55bd6f8633579bdcdab9b264c795ab5
```

---

## #80 — зуминг должен происходить только когда появляется пространство под него, костяшк
**Дата:** 2026-02-06
**Ветка:** dev/Gleb
**Коммит:** `d265b3d`
**Статус:** ✅ готово к переносу

### Изменённые файлы
- `app.js`
- `style.css`
- `tickets/issue-82/screenshot.jpg`

### Как перенести в main
```bash
git cherry-pick d265b3d8a6508ee6fdecdaabf2c14b9516c6d40d
```

---

## #81 — когда нет ходов, перемешивай доску, пускай кости улетят и вернутся в новом поряд
**Дата:** 2026-02-06
**Ветка:** dev/Gleb
**Коммит:** `e276091`
**Статус:** ✅ готово к переносу

### Изменённые файлы
- `app.js`
- `style.css`
- `tickets/issue-82/screenshot.jpg`

### Как перенести в main
```bash
git cherry-pick e2760912b63c8ac6ba25e9a9bc01acb23d3afadb
```

---


## #81 — когда нет ходов, перемешивай доску, пускай кости улетят и вернутся в новом порядке
**Дата:** 2026-02-06
**Ветка:** dev/Gleb
**Коммит:** `1fa8205`
**Статус:** ✅ готово к переносу

### Что сделано
Когда на доске не остаётся доступных ходов, вместо показа экрана "NO MOVES" автоматически запускается перемешивание. Кости разлетаются в стороны с анимацией fly-out, затем тасуются и возвращаются с анимацией fly-in в новом порядке. Ручная кнопка Shuffle тоже использует этот эффект.

### Изменённые файлы
- `app.js` — переписана функция shuffleTiles() с двухфазной анимацией (fly-out → reshuffle → fly-in), checkGameState() вызывает auto-shuffle вместо game over
- `style.css` — добавлена анимация fly-out-anim для разлёта костей

### Как перенести в main
```bash
git cherry-pick 1fa8205df9370fa53085bc033a79772607bad55e
```

---

## #80 — Зуминг должен происходить только когда появляется пространство, автоход по клику
**Дата:** 2026-02-06
**Ветка:** dev/Gleb
**Коммит:** `6476539`
**Статус:** ✅ готово к переносу

### Что сделано
Зуминг теперь вычисляет bounding box оставшихся костяшек и зумит только если масштабированная доска помещается в контейнер — костяшки больше не обрезаются краем экрана. Кнопка Auto (автоход) теперь убирает одну пару за клик вместо непрерывного автоматического разбора.

### Изменённые файлы
- `app.js` — переписан calculateZoomScale() для учёта реального пространства, автоход переделан на single-shot (doAutoMove), удалён interval-based autoplay

### Как перенести в main
```bash
git cherry-pick 64765399c68cbcdeea8d54e5125ea86802e893cc
```

---

## #79 — все еще есть куда увеличивать рисунки на костяшках, есть пространство чтобы сдел
**Дата:** 2026-02-06
**Ветка:** dev/Gleb
**Коммит:** `1776303`
**Статус:** ✅ готово к переносу

### Изменённые файлы
- `app.js`
- `style.css`

### Как перенести в main
```bash
git cherry-pick 17763038bd4db116ccecc3e88c5aa430be33582c
```

---


## #79 — Увеличение рисунков на костяшках, портретная раскладка, анимация полёта по дуге
**Дата:** 2026-02-06
**Ветка:** dev/Gleb
**Коммит:** `baab35c`
**Статус:** ✅ готово к переносу

### Что сделано
Увеличен размер символов на тайлах (0.92 от ширины вместо 0.75) для лучшей читаемости. Раскладка «Черепаха» транспонирована для портретной ориентации телефона — доска теперь выше, чем шире. Удалены декоративные линии справа и снизу от костяшек (tile-side-right, tile-side-bottom, tile-corner) для уменьшения визуального шума. Анимация совпадения пар заменена с прямолинейного полёта на полёт по дуге (bezier curve) — кости летят навстречу по изогнутой траектории и исчезают при соприкосновении.

### Изменённые файлы
- `app.js` — транспонированная раскладка, увеличенный размер шрифта, JS-анимация полёта по дуге (animateArc), удалено создание side/bottom/corner элементов, обновлена проверка свободных тайлов для портретной раскладки
- `style.css` — удалены стили 3D-сторон тайлов, удалена CSS fly-match анимация (заменена на JS), добавлена тень на тайлы

### Как перенести в main
```bash
git cherry-pick baab35ca1cdd3457e8c6873eb7d0efd23899eae2
```

---

## #78 — Сделай эффект сборки костей, когда парные кости летят друг на друга и исчезают к
**Дата:** 2026-02-06
**Ветка:** dev/Gleb
**Коммит:** `216a40d`
**Статус:** ✅ готово к переносу

### Изменённые файлы
- `app.js`
- `index.html`
- `notify.sh`
- `style.css`

### Как перенести в main
```bash
git cherry-pick 216a40da319191fbab976cceb6c9fdd6cce7887d
```

---


## #78 — Эффект сборки костей, анимация доски, кнопка автохода
**Дата:** 2026-02-06
**Ветка:** dev/Gleb
**Коммит:** `3b904d4`
**Статус:** ✅ готово к переносу

### Что сделано
Реализован эффект сборки парных костяшек: при совпадении кости летят друг к другу, соприкасаются и исчезают с партикл-эффектом. Добавлена анимация сборки доски — кости прилетают из-за пределов экрана при старте игры. Добавлена кнопка автохода (Auto) для автоматического разбора маджонга.

### Изменённые файлы
- `app.js` — fly-together анимация, создание частиц, board assembly animation, auto-play логика
- `style.css` — CSS-анимации fly-match, particle-burst, fly-in-anim, стили кнопки Auto
- `index.html` — добавлена кнопка Auto в footer

### Как перенести в main
```bash
git cherry-pick 3b904d440993d41096e1d72ed558b11afb372723
```

---

## #77 — Золотые костяшки пока не нужны
**Дата:** 2026-02-06
**Ветка:** dev/Gleb
**Коммит:** `a75edc1`
**Статус:** ✅ готово к переносу

### Изменённые файлы
- `app.js`
- `style.css`

### Как перенести в main
```bash
git cherry-pick a75edc1bf50f65fcecec3142c010e70d80cb1776
```

---


## #77 — Золотые костяшки пока не нужны
**Дата:** 2026-02-06
**Ветка:** dev/Gleb
**Коммит:** `14ed7c0`
**Статус:** ✅ готово к переносу

### Что сделано
Убраны золотые костяшки (layer-top стиль). Увеличен размер символов на тайлах для максимальной читаемости. Уменьшена толщина 3D-сторон тайлов (с 4px до 2px) чтобы костяшка не выглядела как две, наложенные друг на друга. Адаптирована раскладка под вертикальный формат WebView — изменено соотношение сторон тайла (0.85 вместо 0.78), увеличен максимальный размер тайлов.

### Изменённые файлы
- `app.js` — убрано присвоение класса layer-top, увеличен размер шрифта символов (0.75 вместо 0.55), уменьшен layer offset, изменено соотношение сторон и максимальный размер тайлов
- `style.css` — удалены все стили .layer-top, уменьшена толщина 3D-сторон тайлов с 4px до 2px

### Как перенести в main
```bash
git cherry-pick 14ed7c0c8d9e9cd819bc281d032a290a2bf71553
```

---

## #76 — сделай дизайн максимально приближенно к этому референсу, убедись что костяшки вл
**Дата:** 2026-02-06
**Ветка:** dev/Gleb
**Коммит:** `5be557a`
**Статус:** ✅ готово к переносу

### Изменённые файлы
- `app.js`
- `index.html`
- `style.css`

### Как перенести в main
```bash
git cherry-pick 5be557a20917bff88cf5f4cc64f9a56e15d98598
```

---


## #76 — сделай дизайн максимально приближенно к этому референсу
**Дата:** 2026-02-06
**Ветка:** dev/Gleb
**Коммит:** `28582e0`
**Статус:** ✅ готово к переносу

### Что сделано
Полный редизайн маджонга по референсу: тёмно-зелёный градиентный фон, реалистичные 3D-костяшки с закруглёнными углами и тенями, золотые тайлы верхних слоёв, верхняя панель Level/Score/Matches, нижняя панель с круглыми кнопками Shuffle/Hint в стиле дерева, плавный zoom-in по мере разборки игрового поля.

### Изменённые файлы
- `index.html` — новая структура: верхний бар со статистикой, нижний бар с круглыми кнопками SVG, убран Press Start 2P шрифт
- `style.css` — полный редизайн: зелёный градиент, реалистичные 3D-тайлы, золотые layer-top, деревянный footer, адаптив
- `app.js` — добавлен zoom-in при удалении тайлов, tile-corner элемент, layer-top класс для верхних слоёв

### Как перенести в main
```bash
git cherry-pick 28582e073cd377952e2f65158943e21961a6b5b4
```

---

## #75 — А сделай-ка мне вместо тетриса классическую игру маджонг.
**Дата:** 2026-02-06
**Ветка:** dev/Gleb
**Коммит:** `00cc9b7`
**Статус:** ✅ готово к переносу

### Изменённые файлы
- `app.js`
- `index.html`
- `style.css`

### Как перенести в main
```bash
git cherry-pick 00cc9b7df3f4a131e766fcf4ecec4e88faef4874
```

---


## #75 — А сделай-ка мне вместо тетриса классическую игру маджонг
**Дата:** 2026-02-06
**Ветка:** dev/Gleb
**Коммит:** `e28664c`
**Статус:** ✅ готово к переносу

### Что сделано
Полностью заменён тетрис на классическую игру Mahjong Solitaire. Реализована раскладка "Черепаха" из 144 тайлов на 4 слоях, логика свободных тайлов (без перекрытия сверху и открытый хотя бы один бок), матчинг пар, подсказки, перемешивание, подсчёт очков.

### Изменённые файлы
- `index.html` — новый UI для маджонга (статистика, игровое поле, кнопки Hint/Shuffle)
- `style.css` — стили для тайлов маджонга с 3D-эффектом, адаптивная вёрстка
- `app.js` — полная логика игры маджонг (раскладка, свободные тайлы, матчинг, hint, shuffle)

### Как перенести в main
```bash
git cherry-pick e28664c90585d4e02b7120e9adad8fdf5333f4b3
```

---

## #74 — измени цвет заголовка игры так, чтобы каждая буква писалась разным цветом
**Дата:** 2026-02-06
**Ветка:** dev/Gleb
**Коммит:** `87d23ef`
**Статус:** ✅ готово к переносу

### Изменённые файлы
- `Devlog.md`
- `app.js`
- `index.html`
- `style.css`

### Как перенести в main
```bash
git cherry-pick 87d23ef82ea0dda93d26dd577606e2cbf7a9098a
```

---
